<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <record id="delivery_management_view_tree" model="ir.ui.view">
            <field name="name">delivery_management_view_tree</field>
            <field name="model">delivery.management</field>
            <field name="arch" type="xml">
                <tree create="0" delete="0">
                    <field name="name"/>
                    <field name="origin"/>
                    <field name="delivery_reference"/>
                    <field name="create_date"/>
                    <field name="sender_id"/>
                    <field name="recipient_id"/>
                    <field name="delivery_partner_id"/>
                    <field name="driver_name"/>
                    <field name="delivery_fee"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>

        <record id="delivery_management_view_form" model="ir.ui.view">
            <field name="name">delivery_management_view_form</field>
            <field name="model">delivery.management</field>
            <field name="arch" type="xml">
                <form create="0" delete="0" duplicate="0">
                    <header>
                        <button name="action_send" string="Send" states="draft" type="object" class="oe_highlight"/>
                        <button name="action_get_delivery_detail" string="Get Delivery Details"
                                type="object" class="oe_highlight"/>
                        <button name="action_back" type="object" string="Back" states="queue,failed,cancel"
                                class="oe_highlight"/>
                        <button name="action_cancel" type="object" string="Cancel" states="draft,queue,waiting"
                                class="oe_highlight"
                                attrs="{'invisible': [('state', 'not in', ('draft','queue','waiting','pickup'))]}"
                        />
                        <field name="state" widget="statusbar" clickable="0"/>
                    </header>
                    <sheet>
                        <div>
                            <h2 class="text-center">Delivery Management</h2>
                        </div>
                        <group>
                            <group name="infor_delivery" String="Information Delivery">
                                <field name="name" readonly="1"/>
                                <field name="origin" readonly="1"/>
                                <field name="type_origin" readonly="1"/>
                                <field name="delivery_reference" readonly="1"/>
                                <field name="store_id" readonly="1" options="{'no_create':1, 'no_create_edit':1}"/>
                                <field name="company_id" invisible="1" options="{'no_create':1, 'no_create_edit':1}"/>
                                <field name="delivery_partner_id" attrs="{'readonly' : [('state', '!=', 'draft')]}"
                                       domain="[('active', '=', True)]"
                                       options="{'no_create':1, 'no_create_edit':1, 'no_open':1}"/>
                                <field name="state_delivery" readonly="1"/>
                                <field name="track_url" readonly="1" widget="url"/>
                                <field name="failed_reason" readonly="1" style="word-break: break-all"/>
                            </group>
                            <group name="infor_package" String="Information Package">
                                <field name="qty" required="1" attrs="{'readonly' : [('state', '!=', 'draft')]}"/>
                                <field name="height" string="Height (cm)" required="1"
                                       attrs="{'readonly' : [('state', '!=', 'draft')]}"/>
                                <field name="width" string="Width (cm)" required="1"
                                       attrs="{'readonly' : [('state', '!=', 'draft')]}"/>
                                <field name="depth" string="Depth (cm)" required="1"
                                       attrs="{'readonly' : [('state', '!=', 'draft')]}"/>
                                <field name="weight" string="Weight (kg)" required="1"
                                       attrs="{'readonly' : [('state', '!=', 'draft')]}"/>
                                <field name="distance" readonly="1" force_save="1"/>
                                <field name="delivery_fee" readonly="1" force_save="1"/>
                                <field name="total_price" readonly="1" force_save="1"/>
                                <field name="cod" attrs="{'readonly' : [('state', '!=', 'draft')]}" force_save="1"/>
                            </group>
                            <group name="sender" string="Information Sender">
                                <field name="sender_id" required="1" readonly="1"
                                       options="{'no_create':1, 'no_create_edit':1}"/>
                                <field name="phone_sender" required="1" force_save="1"
                                       readonly="1"/>
                                <field name="address_sender" readonly="1" required="1" force_save="1"/>
                                <field name="lat_sender" force_save="1" readonly="1"/>
                                <field name="long_sender" readonly="1" force_save="1"/>
                            </group>
                            <group name="recipient" string="Information Recipient">
                                <field name="recipient_id" required="1"
                                       attrs="{'readonly' : [('state', '!=', 'draft')]}"
                                       options="{'no_create':1, 'no_create_edit':1}"/>
                                <field name="phone_recipient" required="1"
                                       attrs="{'readonly' : [('state', '!=', 'draft')]}"
                                       force_save="1"/>
                                <field name="address_recipient" required="1"
                                       readonly="1"
                                       force_save="1"/>
                                <field name="lat_recipient"
                                       readonly="1"
                                       force_save="1"/>
                                <field name="long_recipient"
                                       readonly="1"
                                       force_save="1"/>
                            </group>
                            <group>
                                <field name="description" placeholder="description"
                                       attrs="{'readonly' : [('state', '!=', 'draft')]}"/>
                            </group>
                            <group name="driver" string="Information Driver">
                                <field name="driver_name" readonly="1"/>
                                <field name="driver_phone" readonly="1"/>
                                <field name="license_plate" readonly="1"/>
                            </group>
                        </group>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>

        <record id="delivery_management_view_search" model="ir.ui.view">
            <field name="name">Delivery Management Search</field>
            <field name="model">delivery.management</field>
            <field name="arch" type="xml">
                <search string="Parameters">
                    <field name="name" string="Name" filter_domain="[('name','ilike',self)]"/>
                    <field name="origin" string="Origin" filter_domain="[('origin','ilike',self)]"/>
                    <field name="delivery_reference" string="Delivery Reference"
                           filter_domain="[('delivery_reference','ilike',self)]"/>
                    <field name="sender_id" string="Sender Name" filter_domain="[('sender_id.name','ilike',self)]"/>
                    <field name="phone_sender" string="Phone Sender" filter_domain="[('phone_sender','ilike',self)]"/>
                    <field name="recipient_id" string="Recipient Name"
                           filter_domain="[('recipient_id','ilike',self)]"/>
                    <field name="phone_recipient" string="phone Recipient"
                           filter_domain="[('phone_recipient','ilike',self)]"/>
                </search>
            </field>
        </record>

        <record id="ev_delivery_management_action" model="ir.actions.act_window">
            <field name="name">Delivery Management Action</field>
            <field name="res_model">delivery.management</field>
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="delivery_management_view_search"/>
        </record>

        <menuitem id="delivery_menu_root" name="Delivery Management"
                  parent="stock.menu_stock_root"
                  groups="stock.group_stock_user"
                  sequence="1"/>
        <menuitem id="delivery_management_menu" name="Delivery" action="ev_delivery_management_action"
                  parent="ev_delivery_management.delivery_menu_root"
                  groups="stock.group_stock_user"
                  sequence="1"/>
    </data>
</odoo>