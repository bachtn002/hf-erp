<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record id="product_release_search_view_pos" model="ir.ui.view">
            <field name="name">product.release.search.pos.form</field>
            <field name="model">product.template</field>
            <field name="inherit_id" ref="point_of_sale.product_template_search_view_pos"/>
            <field name="arch" type="xml">
                <filter name="filter_to_availabe_pos" position="before">
                    <filter name="filter_to_voucher" string="Voucher" domain="[('x_is_voucher', '=', True)]"/>
                    <filter name="filter_to_blank_card" string="Blank Card" domain="[('x_is_blank_card', '=', True)]"/>
                </filter>
            </field>
        </record>
        <record id="voucher_product_template_form_inherit" model="ir.ui.view">
			<field name="name">voucher.product.template.form.inherit</field>
			<field name="model">product.template</field>
			<field name="inherit_id" ref="product.product_template_form_view"/>
			<field name="priority" eval="8"/>
			<field name="arch" type="xml">
				<xpath expr="//div[@name='options']" position="inside">
					<div>
						<field name="x_is_voucher"/>
                        <label for="x_is_voucher"/>
					</div>
                    <div>
						<field name="x_is_blank_card"/>
                        <label for="x_is_blank_card"/>
					</div>
				</xpath>
            </field>
        </record>
        <record id="release_product_template_form_view_custom" model="ir.ui.view">
            <field name="name">product.template.release.custom.form</field>
            <field name="model">product.template</field>
            <field name="priority">999</field>
            <field name="arch" type="xml">
                <form>
                    <sheet>
                        <field name='product_variant_count' invisible='1'/>
                        <field name='is_product_variant' invisible='1'/>
                        <field name='attribute_line_ids' invisible='1'/>
                        <div class="oe_button_box" name="button_box"/>
                        <widget name="web_ribbon" title="Archived" bg_color="bg-danger"
                                attrs="{'invisible': [('active', '=', True)]}"/>
                        <field name="id" invisible="True"/>
                        <field name="image_1920" widget="image" class="oe_avatar"
                               options="{'preview_image': 'image_128'}"/>
                        <div class="oe_title">
                            <label class="oe_edit_only" for="name" string="Product Name"/>
                            <h1>
                                <field name="name" placeholder="Product Name"/>
                            </h1>
                            <div name="options" groups="base.group_user">
                                <div>
                                    <field name="sale_ok"/>
                                    <label for="sale_ok"/>
                                </div>
                                <div>
                                    <field name="purchase_ok"/>
                                    <label for="purchase_ok"/>
                                </div>
                                <div>
                                    <field name="x_is_blank_card"/>
                                    <label for="x_is_blank_card"/>
                                </div>
                                <div>
                                    <field name="x_is_voucher"/>
                                    <label for="x_is_voucher"/>
                                </div>
                            </div>
                        </div>
                        <notebook>
                            <page string="General Information" name="general_information">
                                <group>
                                    <group name="group_general">
                                        <field name="active" invisible="1"/>
                                        <field name="type"/>
                                        <field name="categ_id" string="Product Category"/>
                                    </group>
                                    <group name="group_standard_price">
                                        <label for="list_price"/>
                                        <div name="pricing">
                                            <field name="list_price" class="oe_inline" widget='monetary'
                                                   options="{'currency_field': 'currency_id', 'field_digits': True}"/>
                                            <button name="open_pricelist_rules" icon="fa-arrow-right" type="object"
                                                    groups="product.group_product_pricelist" class="oe_inline">
                                                <field name="pricelist_item_count"
                                                       attrs="{'invisible': [('pricelist_item_count', '=', 0)]}"/>
                                                <span attrs="{'invisible': [('pricelist_item_count', '=', 1)]}">
                                                    Extra Prices
                                                </span>
                                                <span attrs="{'invisible': [('pricelist_item_count', '!=', 1)]}">
                                                    Extra Price
                                                </span>
                                            </button>
                                        </div>
                                        <label for="standard_price" groups="base.group_user"
                                               attrs="{'invisible': [('product_variant_count', '&gt;', 1), ('is_product_variant', '=', False)]}"/>
                                        <div name="standard_price_uom" groups="base.group_user"
                                             attrs="{'invisible': [('product_variant_count', '&gt;', 1), ('is_product_variant', '=', False)]}"
                                             class="o_row">
                                            <field name="standard_price" widget='monetary'
                                                   options="{'currency_field': 'cost_currency_id', 'field_digits': True}"/>
                                            <span groups="uom.group_uom" class="oe_read_only">per
                                                <field name="uom_name"/>
                                            </span>
                                        </div>
                                        <field name="company_id" groups="base.group_multi_company"
                                               options="{'no_create': True}"/>
                                        <field name="uom_id" groups="uom.group_uom" options="{'no_create': True}"/>
                                        <field name="uom_po_id" groups="uom.group_uom" options="{'no_create': True}"/>
                                        <field name="currency_id" invisible="1"/>
                                        <field name="cost_currency_id" invisible="1"/>
                                        <field name="product_variant_id" invisible="1"/>
                                    </group>
                                </group>
                                <group string="Internal Notes">
                                    <field name="description" nolabel="1"
                                           placeholder="This note is only for internal purposes."/>
                                </group>
                            </page>
                            <page name="variants" string="Variants" groups="product.group_product_variant">
                                <field name="attribute_line_ids" widget="one2many" context="{'show_attribute': False}">
                                    <tree string="Variants" editable="bottom">
                                        <field name="attribute_id" attrs="{'readonly': [('id', '!=', False)]}"/>
                                        <field name="value_ids" widget="many2many_tags"
                                               options="{'no_create_edit': True}"
                                               context="{'default_attribute_id': attribute_id, 'show_attribute': False}"/>
                                    </tree>
                                </field>
                                <p class="oe_grey oe_edit_only">
                                    <strong>Warning</strong>: adding or deleting attributes
                                    will delete and recreate existing variants and lead
                                    to the loss of their possible customizations.
                                </p>
                            </page>
                            <page string="Sales" attrs="{'invisible':[('sale_ok','=',False)]}" name="sales">
                                <group name="sale">
                                    <group string="Invoicing">
                                        <field name="invoice_policy" widget="radio"/>
                                        <field name="expense_policy" widget="radio"/>
                                    </group>
                                </group>
                                <group string="Sales Description" name="description">
                                    <field name="description_sale" nolabel="1"
                                           placeholder="This note is added to sales orders and invoices."/>
                                </group>
                            </page>
                            <page name="pos" string="Point of Sale">
                                <group name="pos">
                                    <group>
                                        <field name="available_in_pos"/>
                                        <field name="pos_categ_id"
                                               attrs="{'invisible': [('available_in_pos', '=', False)]}"
                                               string="Category"/>
                                        <field name="to_weight"
                                               attrs="{'invisible': [('available_in_pos', '=', False)]}"/>
                                    </group>
                                </group>
                            </page>
                            <page string="Inventory" name="inventory">
                                <group name="inventory">
                                    <field name="has_available_route_ids" invisible="1"/>
                                    <group string="Operations" name="operations">
                                        <label for="route_ids"
                                               attrs="{'invisible': [('type', 'in', ['service', 'digital'])]}"/>
                                        <div>
                                            <field name="route_ids" class="mb-0" widget="many2many_checkboxes"
                                                   attrs="{'invisible': ['|', ('has_available_route_ids', '=', False), ('type', 'in', ['service', 'digital'])]}"/>
                                        </div>
                                        <field name="route_from_categ_ids" widget="many2many_tags" readonly="1"
                                               attrs="{'invisible': [('route_from_categ_ids', '=', [])]}"/>
                                    </group>
                                    <group name="group_lots_and_weight" string="Logistics"
                                           attrs="{'invisible': [('type', 'not in', ['product', 'consu'])]}">
                                        <field name="responsible_id" domain="[('share', '=', False)]"/>
                                        <label for="weight"
                                               attrs="{'invisible':[('product_variant_count', '>', 1), ('is_product_variant', '=', False)]}"/>
                                        <div class="o_row" name="weight"
                                             attrs="{'invisible':[('product_variant_count', '>', 1), ('is_product_variant', '=', False)]}">
                                            <field name="weight"/>
                                            <span>
                                                <field name="weight_uom_name"/>
                                            </span>
                                        </div>
                                        <label for="volume"
                                               attrs="{'invisible':[('product_variant_count', '>', 1), ('is_product_variant', '=', False)]}"/>
                                        <div class="o_row" name="volume"
                                             attrs="{'invisible':[('product_variant_count', '>', 1), ('is_product_variant', '=', False)]}">
                                            <field name="volume" string="Volume"/>
                                            <span>
                                                <field name="volume_uom_name"/>
                                            </span>
                                        </div>
                                        <label for="sale_delay" attrs="{'invisible': [('sale_ok', '=', False)]}"/>
                                        <div attrs="{'invisible': [('sale_ok', '=', False)]}">
                                            <field name="sale_delay" class="oe_inline" style="vertical-align:baseline"/>
                                            days
                                        </div>
                                    </group>
                                    <group string="Traceability" name="traceability"
                                           groups="stock.group_production_lot">
                                        <field name="tracking" widget="radio"
                                               attrs="{'invisible': [('type', 'in', ['service', 'digital'])]}"/>
                                    </group>
                                    <group string="Counterpart Locations" name="stock_property"
                                           groups="base.group_no_one">
                                        <field name="property_stock_production"/>
                                        <field name="property_stock_inventory"/>
                                    </group>
                                </group>
                                <group name="packaging" string="Packaging"
                                       colspan="4"
                                       attrs="{'invisible':['|', ('type', 'not in', ['product', 'consu']), ('product_variant_count', '>', 1), ('is_product_variant', '=', False)]}"
                                       groups="product.group_stock_packaging">
                                    <field name="packaging_ids" nolabel="1"
                                           context="{'tree_view_ref':'product.product_packaging_tree_view2', 'form_view_ref':'product.product_packaging_form_view2'}"/>
                                </group>
                                <group string="Description for Delivery Orders">
                                    <field name="description_pickingout" nolabel="1"
                                           placeholder="This note is added to delivery orders."/>
                                </group>
                                <group string="Description for Receipts">
                                    <field name="description_pickingin" nolabel="1"
                                           placeholder="This note is added to receipt orders (e.g. where to store the product in the warehouse)."/>
                                </group>
                                <group string="Description for Internal Transfers"
                                       groups="stock.group_stock_multi_locations">
                                    <field name="description_picking"
                                           placeholder="This note is added to internal transfer orders (e.g. where to pick the product in the warehouse)."
                                           nolabel="1"/>
                                </group>
                            </page>
                            <page string="Accounting" name="invoicing" groups="account.group_account_readonly">
                                <group name="properties">
                                    <group string="Receivables">
                                        <field name="property_account_income_id"
                                               groups="account.group_account_readonly"/>
                                    </group>
                                    <group string="Payables" name="payables">
                                        <field name="property_account_expense_id"
                                               groups="account.group_account_readonly"/>
                                        <field name="property_account_creditor_price_difference"
                                               domain="[('deprecated','=',False)]"
                                               groups="account.group_account_readonly"/>
                                    </group>
                                </group>
                                <group name="accounting"/>
                            </page>
                            <page string="Information card"
                                  attrs="{'invisible': ['|',('x_is_voucher', '=', False),('x_is_blank_card','=',True)]}">
                                <group>
                                    <group>
                                        <field name="x_use_policy"/>
                                    </group>
                                    <group>
                                        <field name="check_discount_price"/>
                                        <field name='x_card_value' attrs="{'invisible': [('check_discount_price','not in',('price'))]}"/>
                                        <field name='x_card_discount' attrs="{'invisible': [('check_discount_price','not in',('discount'))]}"/>
                                        <field name='rule_apply_promotion' widget="boolean_toggle"/>
                                    </group>
                                </group>
                                <notebook>
                                    <page string="Product sevice" attrs="{'invisible': [('rule_apply_promotion', '=', False)]}">
                                        <field name="x_and_condition"/>
                                        <label for="x_and_condition"/>
                                        <br/>
                                        <field name="x_or_condition"/>
                                        <label for="x_or_condition"/>
                                        <br/>
                                        <field name="field_binary_import" filename="field_binary_name"/>
                                        <field name="field_binary_name" invisible="1"/>
                                        <button type="object" name="action_import_product_card" class="oe_highlight" string="Import"
                                            attrs="{'invisible': [('field_binary_import', '=', False)]}"/>
                                        <button name="download_template" type="object" string="Download Import Template"
                                                class="btn btn-link" style="text-decoration: underline;"
                                                help="Mẫu import có định dạng là xls hoặc xlsx"/>
                                        <field name="x_product_card_ids">
                                            <tree editable="1">
                                                <field name="product_id" invisible="1"/>
                                                <field name="product_allow_id"/>
<!--                                                <field name="maximum_quantity"/>-->
                                            </tree>
                                            <form>
                                                <group>
                                                    <group>
                                                        <field name="product_allow_id"
                                                               options="{'no_create':1, 'no_create_edit':1}"/>
                                                    </group>
                                                    <group>
<!--                                                        <field name="maximum_quantity"/>-->
                                                    </group>
                                                </group>
                                            </form>
                                        </field>

                                    </page>
                                    <page string="Product Category sevice" attrs="{'invisible': [('rule_apply_promotion', '=', False)]}">
                                        <field name="field_binary_import" filename="field_binary_name"/>
                                        <field name="field_binary_name" invisible="1"/>
                                        <button name="action_import_category_card" type="object" class="oe_highlight" string="Import"
                                            attrs="{'invisible': [('field_binary_import', '=', False)]}"/>
                                        <button name="download_template" type="object" string="Download Import Template"
                                                class="btn btn-link" style="text-decoration: underline;"
                                                help="Mẫu import có định dạng là xls hoặc xlsx"/>
                                        <field name="x_product_category_card_ids">
                                            <tree editable="1">
                                                <field name="product_id" invisible="1"/>
                                                <field name="product_category_allow_id"/>
<!--                                                <field name="maximum_quantity"/>-->
                                            </tree>
                                            <form>
                                                <group>
                                                    <group>
                                                        <field name="product_category_allow_id"
                                                               options="{'no_create':1, 'no_create_edit':1}"/>
                                                    </group>
                                                    <group>
<!--                                                        <field name="maximum_quantity"/>-->
                                                    </group>
                                                </group>
                                            </form>
                                        </field>
                                    </page>
                                </notebook>
                            </page>
                        </notebook>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids"/>
                        <field name="activity_ids"/>
                        <field name="message_ids"/>
                    </div>
                </form>
            </field>
        </record>

        <record id="product_template_release_tree_view_custom" model="ir.ui.view">
            <field name="name">product.template.release.custom.tree</field>
            <field name="model">product.template</field>
            <field name="priority">999</field>
            <field name="arch" type="xml">
                <tree string="Product" multi_edit="1" sample="1">
                    <field name="product_variant_count" invisible="1"/>
                    <field name="sale_ok" invisible="1"/>
                    <field name="currency_id" invisible="1"/>
                    <field name="cost_currency_id" invisible="1"/>

                    <field name="sequence" widget="handle" readonly="1"/>
                    <field name="name" string="Product Name"/>
                    <field name="default_code" optional="show"/>
                    <field name="barcode" optional="hide" attrs="{'readonly': [('product_variant_count', '>', 1)]}"/>
                    <field name="company_id" options="{'no_create_edit': True}"
                           groups="base.group_multi_company" optional="hide"/>
                    <field name="list_price" string="Sales Price" widget='monetary'
                           options="{'currency_field': 'currency_id'}" optional="show" decoration-muted="not sale_ok"/>
                    <field name="standard_price" widget='monetary' options="{'currency_field': 'cost_currency_id'}"
                           optional="show" readonly="1"/>
                    <field name="categ_id" optional="hide"/>
                    <field name="type" optional="hide" readonly="1"/>
                    <field name="uom_id" readonly="1" optional="show" groups="uom.group_uom"/>
                    <field name="active" invisible="1"/>
                    <field name="activity_exception_decoration" widget="activity_exception"/>
                </tree>
            </field>
        </record>

        <record id="product_release_action_custom" model="ir.actions.act_window">
            <field name="name">Voucher</field>
            <field name="res_model">product.template</field>
            <field name="type">ir.actions.act_window</field>
            <field name="view_mode">kanban,tree,form</field>
            <field name="view_ids" eval="[(5, 0, 0),
                        (0, 0, {'view_mode': 'kanban', 'view_id': ref('product.product_template_kanban_view')}),
                        (0, 0, {'view_mode': 'tree', 'view_id': ref('ev_product_release.product_template_release_tree_view_custom')}),
                        (0, 0, {'view_mode': 'form', 'view_id': ref('ev_product_release.release_product_template_form_view_custom')})]"/>
            <field name="context"
                   eval="{'search_default_filter_to_voucher': 1,
                            'search_default_filter_to_blank_card': 1,
                            'default_x_is_voucher': False,
                            'default_type': 'service',
                            'default_available_in_pos': True,
                            'default_x_is_voucher': False,
                            'default_purchase_ok': False,
                            'default_tracking':'serial'}"/>
            <field name="domain">['|', ('x_is_voucher', '=', True), ('x_is_blank_card', '=', True)]</field>
        </record>

<!--        <menuitem id="menu_pos_products_release_custom"-->
<!--                  action="ev_product_release.product_release_action_custom"-->
<!--                  parent="ev_pos_erpviet.menu_pos_config_custom"-->
<!--                  sequence="50"/>-->
            <menuitem id="menu_pos_products_release_custom"
                      action="ev_product_release.product_release_action_custom"
                      parent="ev_product_release.menu_pos_voucher"
                      sequence="50"/>
    </data>
</odoo>